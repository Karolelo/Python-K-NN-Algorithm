See second branch there is all algorithm written
